/*VIEW SCRIPT FOR all_merged*/

CREATE OR REPLACE VIEEW `burner-manchoud1.bbb_all_data_merged.all_merged` AS 
SELECT dd.Customer_ID, 
  dd.Speed, 
  dd.Acceleration, 
  dd.Braking, 
  dd.Distance, 
  dd.Time_spent_driving, 
  dd.Fuel_consumption, 
  dd.RPM, 
  dd.Gear_changes, 
  dd.Lane_changes, 
  dd.GPS_location,
  pr.Starting_location, 
  pr.Ending_location, 
  pr.Route_taken, 
  pr.Distance AS pr_Distance, 
  pr.Time_taken AS pr_Time_taken, 
  pr.Traffic_conditions, 
  pr.Preferred_time, 
  pr.Mode_of_transportation, 
  pr.Weather_conditions, 
  pr.Points_of_interest,
  s.Seatbelt_usage, 
  s.Speeding_incidents, 
  s.Frequency_of_hard_braking, 
  s.Frequency_of_hard_acceleration, 
  s.Frequency_of_sudden_lane_changes, 
  s.Time_of_day, 
  s.Weather_conditions AS s_Weather_conditions, 
  s.Distraction_level, 
  s.Road_type, 
  s.Average_time_between_vehicle_maintenance,
  cb.car_id, 
  cb.latitude, 
  cb.longitude, 
  cb.rock, 
  cb.__Artist86__, 
  cb.__Song68____Song80____Song61____Song31__, 
  cb.calming, 
  cb.loud, 
  cb.__, 
  cb.__Playlist10__, 
  cb.satellite, 
  cb.cassette_player, 
  cb._0, 
  cb._3, 
  cb._3_15, 
  cb._5, 
  cb._1, 
  cb.day, 
  cb.rainy, 
  cb.medium, 
  cb.rural, 
  cb._6_months, 
  cb._83_8510418911526, 
  cb._6_4842664605686196, 
  cb._0_007485378885985106, 
  cb._423_7326630878021, 
  cb._4_358436988027334, 
  cb._9_652465351819107, 
  cb._3843_020079544318, 
  cb._10, 
  cb._1_31, 
  cb.__62_4089660083599___129_42258034698418_ 
FROM `burner-manchoud1.bbb_hackathon_data.DRIVING_DATA` AS dd
LEFT JOIN `burner-manchoud1.bbb_hackathon_data.PREFERED_ROUTES` AS pr
  ON dd.Customer_ID = pr.Customer_ID
LEFT JOIN `burner-manchoud1.bbb_hackathon_data.SAFETY` AS s
  ON dd.Customer_ID = s.Customer_ID
LEFT JOIN `burner-manchoud1.bbb_hackathon_data.CUSTOMER_BEHAVIOR` AS cb
  ON dd.Customer_ID = cb.customer_id
where Mode_of_transportation ='Car';